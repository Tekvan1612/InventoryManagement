{% include 'product_tracking/head.html' %}
{% load static %}


<style>
    .modal-dialog {
        max-width: 75%; /* Ensures the modal doesn't exceed screen width */
        margin: 1.75rem auto; /* Centers the modal with some margin on top and bottom */
    }

    .modal-content {
        padding: 15px;
    }

    .modal-body {
        padding-bottom: 10px;
        overflow-y: scroll; /* Enables scrolling if content overflows */
        max-height: 85vh; /* Limits the modal height to 70% of the viewport height */
    }

    @media (min-width: 768px) {
        .modal-lg {
            max-width: 80%; /* Adjusts for larger screens */
        }

        .modal-body {
            max-height: 80vh; /* Increases max height for larger screens */
        }
    }

    @media (max-width: 767.98px) {
        .modal-dialog {
            max-width: 100%; /* Ensures modal fits within small screens */
            margin: 10px; /* Adds some margin for extra small devices */
        }

        .modal-body {
            max-height: 60vh; /* Reduces max height for smaller screens */
        }
    }

    @media (max-width: 575.98px) {
        .modal-content {
            padding: 10px; /* Reduces padding for small screens */
        }

        .modal-body {
            max-height: 50vh; /* Further reduces max height for extra small screens */
        }
    }

    .plus-icon {
        cursor: pointer;
        color: #ffffff;
        text-align: center;
        display: inline-block;
        width: 100%;
        font-size: 1.2rem; /* Increase font size if needed */
    }

    .modal-content {
        max-width: 800px;
        margin: auto;
    }

    .table-responsive table th,
    .table-responsive table td {
        padding: 0.75rem;
        vertical-align: middle;
    }

    .table-responsive table th.country-col,
    .table-responsive table td.country-col {
        width: 15%; /* Adjust this percentage as needed */
    }

    .table-responsive table th.state-col,
    .table-responsive table td.state-col {
        width: 15%; /* Adjust this percentage as needed */
    }

    .table-responsive table th.city-col,
    .table-responsive table td.city-col {
        width: 10%; /* Adjust this percentage as needed */
    }

    .table-responsive table th.postcode-col,
    .table-responsive table td.postcode-col {
        width: 10%; /* Adjust this percentage as needed */
    }

    .table-responsive table th.billing-col,
    .table-responsive table td.billing-col {
        width: 20%; /* Adjust this percentage as needed */
    }

    .table-responsive table th.company-col,
    .table-responsive table td.company-col {
        width: 20%; /* Adjust this percentage as needed */
    }

    #addContactPerson .fa-plus {
        font-size: 1.5rem;
        margin-right: 5px;
    }

    /* Table Styling */
    .table {
        width: 100%;
        margin-bottom: 1rem;
        color: #212529;
        border-collapse: collapse;
    }

    .table th,
    .table td {
        padding: 0.75rem;
        vertical-align: top;
        border-top: 1px solid #dee2e6;
    }

    .table thead th {
        background-color: #444444; /* Background color for table headers */
        color: #ffffff; /* Text color for table headers */
    }

    .table tbody + tbody {
        border-top: 2px solid #dee2e6;
    }

    .table-bordered {
        border: 1px solid #dee2e6;
    }

    .table-bordered th,
    .table-bordered td {
        border: 1px solid #dee2e6;
    }

    .table-hover tbody tr:hover {
        background-color: #f1f1f1;
    }

    .table-responsive {
        display: block;
        width: 100%;
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
    }

    .table-striped tbody tr:nth-of-type(odd) {
        background-color: rgba(0, 0, 0, 0.05);
    }

    .table-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
    }

    .table-footer .pagination {
        margin: 0;
    }

    .table-footer .pagination .page-item .page-link {
        color: #007bff;
        border-radius: 50%;
        padding: 0.5rem 0.75rem;
        margin: 0 2px;
        border: 1px solid #dee2e6;
    }

    .table-footer .pagination .page-item.active .page-link {
        background-color: #007bff;
        border-color: #007bff;
        color: #fff;
    }

    .table-responsive::-webkit-scrollbar {
        height: 8px;
    }

    .table-responsive::-webkit-scrollbar-thumb {
        background-color: #007bff;
        border-radius: 10px;
    }

    .table-responsive::-webkit-scrollbar-track {
        background-color: #f1f1f1;
    }

    .modal-header {
        background-color: #007bff;
        color: white;
        border-bottom: 1px solid #dee2e6;
    }

    .nav-tabs .nav-link {
        font-size: 1rem;
        border-radius: 5px;
        font-weight: 600;
        padding: 10px 20px;
        color: #ffffff; /* Text color for unselected tabs */
        background-color: #2c2c2c; /* Background color for unselected tabs */
        transition: background-color 0.3s ease, color 0.3s ease;
        margin-right: 5px;
        border: 1px solid #444444; /* Border color for unselected tabs */
    }

    .nav-tabs .nav-link.active {
        color: #ffffff !important;
        background-color: #007bff !important; /* Highlight color for selected tab */
        border-color: #007bff #007bff #ffffff !important;
        border-radius: 5px;
    }

    .tab-content {
        padding: 20px;
        border: 1px solid #444444; /* Border color for tab content */
        border-top: 0;
        border-radius: 0 5px 5px 5px;
        background-color: #333333; /* Background color for tab content */
        color: #ffffff; /* Text color for tab content */
    }

    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
    }

    #main-wrapper {
        min-height: 100%;
        display: flex;
        flex-direction: column;
    }

    .content-body {
        flex: 1;
    }

    .form-control {
        border-radius: 4px;
        border: 1px solid #ccc;
        padding: 10px;
    }

    .btn-primary {
        background-color: #007bff;
        border-color: #007bff;
    }

    .btn-secondary {
        background-color: #6c757d;
        border-color: #6c757d;
    }

    .btn-danger {
        background-color: #dc3545;
        border-color: #dc3545;
    }

    .modal-body {
        padding: 20px;
    }

    .form-group {
        margin-bottom: 15px;
    }

    .form-group label {
        font-weight: 600;
    }

    .table tbody tr {
        background-color: #2c2c2c; /* Background color for table rows */
        color: #ffffff; /* Text color for table rows */
    }

    .table tbody tr:hover {
        background-color: #3b3b3b; /* Hover effect for table rows */
    }

    /* Adjust scrollbars for dark theme */
    .table-responsive::-webkit-scrollbar {
        height: 8px;
    }

    .table-responsive::-webkit-scrollbar-thumb {
        background-color: #007bff; /* Scrollbar color */
        border-radius: 10px;
    }

    .table-responsive::-webkit-scrollbar-track {
        background-color: #2c2c2c; /* Scrollbar track color */
    }

    /* Footer adjustment for dark theme */
    .modal-header {
        background-color: #007bff;
        color: white;
        border-bottom: 1px solid #444444;
    }

    .btn-primary {
        background-color: #007bff;
        border-color: #007bff;
    }

    .btn-secondary {
        background-color: #6c757d;
        border-color: #6c757d;
    }

    .btn-danger {
        background-color: #dc3545;
        border-color: #dc3545;
    }

    .form-control {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
    }

    .modal-footer {
        border-top: 1px solid #dee2e6;
        padding: 10px;
    }
</style>

{% block content %}
    <body data-typography="poppins" data-theme-version="light" data-layout="vertical" data-nav-headerbg="black"
          data-headerbg="color_1">

    <!-- Preloader start -->
    <div id="preloader">
        <div class="lds-ripple">
            <div></div>
            <div></div>
        </div>
    </div>
    <!-- Preloader end -->

    <!-- Main wrapper start -->
    <div id="main-wrapper">
        <!-- Nav header start -->
        {% include 'product_tracking/navheader.html' %}
        <!-- Nav header end -->

        <!-- Header start -->
        {% include 'product_tracking/header.html' %}
        <!-- Header end -->

        <!-- Sidebar start -->
        {% include 'product_tracking/sidebar.html' %}
        <!-- Sidebar end -->

        <!-- Content body start -->
        <div class="content-body">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12">
                        <div class="card h-auto">
                            <div class="card-body">
                                <ul class="nav nav-tabs custom-tab" id="contactTabs" role="tablist">
                                    <li class="nav-item" role="presentation">
                                        <a class="nav-link active" id="company-tab" data-bs-toggle="tab"
                                           href="#company" role="tab" aria-controls="company"
                                           aria-selected="true">Company</a>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <a class="nav-link" id="venue-tab" data-bs-toggle="tab"
                                           href="#venue" role="tab" aria-controls="venue"
                                           aria-selected="false">Venue</a>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                        <a class="nav-link" id="individual-tab" data-bs-toggle="tab"
                                           href="#individual" role="tab" aria-controls="individual"
                                           aria-selected="false">Individual</a>
                                    </li>
                                </ul>

                                <!-- Search bar -->
                                <div class="row my-3">
                                    <div class="col-md-6">
                                        <input type="text" id="search-input" class="form-control"
                                               placeholder="Search...">
                                    </div>
                                </div>


                                <div class="tab-content p-3 border border-top-0 rounded-bottom"
                                     id="contactTabContent">
                                    <!-- Company Tab Content -->
                                    <div class="tab-pane fade show active" id="company" role="tabpanel"
                                         aria-labelledby="company-tab">
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-responsive-sm">
                                                <thead>
                                                <tr>
                                                    <th><span class="plus-icon" id="addCompanyRow">+</span></th>
                                                    <th>Company Name</th>
                                                    <th>GST No</th>
                                                    <th>PAN No</th>
                                                    <th>Email</th>
                                                    <th>Office Address</th>
                                                    <th>Billing Address</th>
                                                    <th>City</th>
                                                    <th>State</th>
                                                    <th>Country</th>                                                   
                                                    <th>Postcode</th>
                                                </tr>
                                                </thead>
                                                <tbody id="company-table-body">
                                                <!-- Company rows will be appended here by JavaScript -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <!-- Venue Tab Content -->
                                    <div class="tab-pane fade" id="venue" role="tabpanel" aria-labelledby="venue-tab">
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-responsive-sm">
                                                <thead>
                                                <tr>
                                                    <th><span class="plus-icon" id="addVenueRow">+</span></th>
                                                    <th>Venue Name</th>
                                                    <th>Venue Address</th>
                                                    <th>City</th>
                                                    <th>State</th>
                                                    <th>Country</th>                                                    
                                                    <th>Postcode</th>
                                                </tr>
                                                </thead>
                                                <tbody id="venue-table-body">
                                                <!-- Venue rows will be appended here by JavaScript -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>

                                    <!-- Individual Tab Content -->
                                    <div class="tab-pane fade" id="individual" role="tabpanel"
                                         aria-labelledby="individual-tab">
                                        <div class="table-responsive">
                                            <table class="table table-bordered table-responsive-sm">
                                                <thead>
                                                <tr>
                                                    <th><span class="plus-icon" id="addIndividualRow">+</span></th>
                                                    <th>Name</th>
                                                    <th>Mobile No</th>
                                                    <th>Social No</th>
                                                    <th>Email</th>
                                                    <th>Company</th>
                                                    <th>Address</th>
                                                    <th>City</th>
                                                    <th>State</th>
                                                    <th>Country</th>
                                                    <th>Postcode</th>
                                                </tr>
                                                </thead>
                                                <tbody id="individual-table-body">
                                                <!-- Individual rows will be appended here by JavaScript -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div> <!-- End of outer column -->
                </div> <!-- End of outer row -->
            </div>
        </div>
        <!-- Content body end -->

        <div class="modal fade" id="categoryModal" tabindex="-1" aria-labelledby="categoryModalLabel"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-md"> <!-- Use modal-lg for a larger modal -->
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="categoryModalLabel">Company Details</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="company-information" role="tabpanel"
                                 aria-labelledby="company-information-tab">

                                <!-- Equipment Details Form -->
                                <form id="companyInformationForm" method="POST">
                                    {% csrf_token %}
                                    <!-- Grouped Form Elements in a Single Row -->
                                    <div class="row custom-margin">
                                        <!-- Input Box -->
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="companyName" class="form-label">Company Name</label>
                                            <input type="text" class="form-control" id="companyName"
                                                   placeholder="Company Name" required>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="gstNo" class="form-label">GST No</label>
                                            <input type="text" class="form-control" id="gstNo" placeholder="GST No"
                                                   required>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="panNo" class="form-label">PAN No</label>
                                            <input type="text" class="form-control" id="panNo" placeholder="PAN No"
                                                   required>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="companyEmail" class="form-label">Email</label>
                                            <input type="email" class="form-control" id="companyEmail"
                                                   placeholder="Email" required>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="officeAddress" class="form-label">Office Address</label>
                                            <textarea class="form-control" id="officeAddress"
                                                      placeholder="Office Address" required rows="3"></textarea>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="billingAddress" class="form-label">Billing Address</label>
                                            <textarea class="form-control" id="billingAddress"
                                                      placeholder="Billing Address" required rows="3"></textarea>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="country" class="form-label">Country</label>
                                            <select class="form-control" id="country">
                                                <option value="India" selected>India</option>
                                                <!-- Add more countries if needed -->
                                            </select>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="state" class="form-label">State</label>
                                            <select class="form-control state" id="state">
                                                <option value="">Please select</option>
                                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                                <option value="Assam">Assam</option>
                                                <option value="Bihar">Bihar</option>
                                                <option value="Chhattisgarh">Chhattisgarh</option>
                                                <option value="Goa">Goa</option>
                                                <option value="Gujarat">Gujarat</option>
                                                <option value="Haryana">Haryana</option>
                                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                                <option value="Jharkhand">Jharkhand</option>
                                                <option value="Karnataka">Karnataka</option>
                                                <option value="Kerala">Kerala</option>
                                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                                <option value="Maharashtra">Maharashtra</option>
                                                <option value="Manipur">Manipur</option>
                                                <option value="Meghalaya">Meghalaya</option>
                                                <option value="Mizoram">Mizoram</option>
                                                <option value="Nagaland">Nagaland</option>
                                                <option value="Odisha">Odisha</option>
                                                <option value="Punjab">Punjab</option>
                                                <option value="Rajasthan">Rajasthan</option>
                                                <option value="Sikkim">Sikkim</option>
                                                <option value="Tamil Nadu">Tamil Nadu</option>
                                                <option value="Telangana">Telangana</option>
                                                <option value="Tripura">Tripura</option>
                                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                                <option value="Uttarakhand">Uttarakhand</option>
                                                <option value="West Bengal">West Bengal</option>
                                                <option value="Andaman and Nicobar Islands">Andaman and Nicobar
                                                    Islands
                                                </option>
                                                <option value="Chandigarh">Chandigarh</option>
                                                <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar
                                                    Haveli and Daman and Diu
                                                </option>
                                                <option value="Lakshadweep">Lakshadweep</option>
                                                <option value="Delhi">Delhi</option>
                                                <option value="Puducherry">Puducherry</option>
                                                <option value="Ladakh">Ladakh</option>
                                                <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                            </select>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="city" class="form-label">City</label>
                                            <input type="text" class="form-control" id="city" placeholder="City"
                                                   required>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="postcode" class="form-label">Postcode</label>
                                            <input type="text" class="form-control" id="postcode" placeholder="Postcode"
                                                   required>
                                        </div>
                                        <!-- Buttons Section -->
                                        <div class="d-flex justify-content-end">
                                            <button type="button" class="btn btn-secondary me-2" id="closeFormBtn"
                                                    data-bs-dismiss="modal">Close
                                            </button>
                                            <button type="submit" class="btn btn-primary" id="saveCompanyChanges">Submit
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="venueModal" tabindex="-1" aria-labelledby="venueModalLabel"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-md"> <!-- Use modal-lg for a larger modal -->
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="venueModalLabel">Venue Details</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="venue-information" role="tabpanel"
                                 aria-labelledby="venue-information-tab">

                                <!-- Equipment Details Form -->
                                <form id="venueInformationForm" method="POST">
                                    {% csrf_token %}
                                    <!-- Grouped Form Elements in a Single Row -->
                                    <div class="row custom-margin">
                                        <!-- Input Box -->
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="companyName" class="form-label">Venue Name</label>
                                            <input type="text" class="form-control venue-name" id="venueName"
                                                   placeholder="Venue Name">
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="gstNo" class="form-label">Venue Address</label>
                                            <input type="text" class="form-control venue-address" id="venueAddress"
                                                   placeholder="Venue Address">
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="country" class="form-label">Country</label>
                                            <select class="form-control" id="venueCountry">
                                                <option value="India" selected>India</option>
                                                <!-- Add more countries if needed -->
                                            </select>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="state" class="form-label">State</label>
                                            <select class="form-control state" id="venueState">
                                                <option value="">Please select</option>
                                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                                <option value="Assam">Assam</option>
                                                <option value="Bihar">Bihar</option>
                                                <option value="Chhattisgarh">Chhattisgarh</option>
                                                <option value="Goa">Goa</option>
                                                <option value="Gujarat">Gujarat</option>
                                                <option value="Haryana">Haryana</option>
                                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                                <option value="Jharkhand">Jharkhand</option>
                                                <option value="Karnataka">Karnataka</option>
                                                <option value="Kerala">Kerala</option>
                                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                                <option value="Maharashtra">Maharashtra</option>
                                                <option value="Manipur">Manipur</option>
                                                <option value="Meghalaya">Meghalaya</option>
                                                <option value="Mizoram">Mizoram</option>
                                                <option value="Nagaland">Nagaland</option>
                                                <option value="Odisha">Odisha</option>
                                                <option value="Punjab">Punjab</option>
                                                <option value="Rajasthan">Rajasthan</option>
                                                <option value="Sikkim">Sikkim</option>
                                                <option value="Tamil Nadu">Tamil Nadu</option>
                                                <option value="Telangana">Telangana</option>
                                                <option value="Tripura">Tripura</option>
                                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                                <option value="Uttarakhand">Uttarakhand</option>
                                                <option value="West Bengal">West Bengal</option>
                                                <option value="Andaman and Nicobar Islands">Andaman and Nicobar
                                                    Islands
                                                </option>
                                                <option value="Chandigarh">Chandigarh</option>
                                                <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar
                                                    Haveli and Daman and Diu
                                                </option>
                                                <option value="Lakshadweep">Lakshadweep</option>
                                                <option value="Delhi">Delhi</option>
                                                <option value="Puducherry">Puducherry</option>
                                                <option value="Ladakh">Ladakh</option>
                                                <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                            </select>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="city" class="form-label">City</label>
                                            <input type="text" class="form-control" id="venueCity" placeholder="City"
                                                   required>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="postcode" class="form-label">Postcode</label>
                                            <input type="text" class="form-control" id="venuePostcode"
                                                   placeholder="Postcode"
                                                   required>
                                        </div>

                                        <!-- Buttons Section -->
                                        <div class="d-flex justify-content-end">
                                            <button type="button" class="btn btn-secondary me-2" id="closeFormBtn"
                                                    data-bs-dismiss="modal">Close
                                            </button>
                                            <button type="submit" class="btn btn-primary" id="saveVenueChanges">Submit
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="individualModal" tabindex="-1" aria-labelledby="individualModalLabel"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered modal-md"> <!-- Use modal-lg for a larger modal -->
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="individualModalLabel">Individual Details</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="tab-content">
                            <div class="tab-pane fade show active" id="individual-information" role="tabpanel"
                                 aria-labelledby="individual-information-tab">

                                <!-- Equipment Details Form -->
                                <form id="individualInformationForm" method="POST">
                                    {% csrf_token %}
                                    <!-- Grouped Form Elements in a Single Row -->
                                    <div class="row custom-margin">
                                        <!-- Input Box -->
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="companyName" class="form-label">Name</label>
                                            <input type="text" class="form-control individual-name" id="individualName"
                                                   placeholder="Name">
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="gstNo" class="form-label">Mobile No</label>
                                            <input type="text" class="form-control individual-mobile"
                                                   id="individualMobileNo"
                                                   placeholder="Mobile No">
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="panNo" class="form-label">Social No</label>
                                            <input type="text" class="form-control individual-social"
                                                   id="individualSocialNo"
                                                   placeholder="Social No">
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="companyEmail" class="form-label">Email</label>
                                            <input type="email" class="form-control individual-email"
                                                   id="individualEmail"
                                                   placeholder="Email">
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="officeAddress" class="form-label">Company</label>
                                            <select class="form-control individual-company"
                                                    id="individualCompanyName"></select>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="billingAddress" class="form-label">Address</label>
                                            <textarea class="form-control" id="individualAddress"
                                                      placeholder="Billing Address" required rows="3"></textarea>
                                        </div>

                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="country" class="form-label">Country</label>
                                            <select class="form-control" id="individualCountry">
                                                <option value="India" selected>India</option>
                                                <!-- Add more countries if needed -->
                                            </select>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="state" class="form-label">State</label>
                                            <select class="form-control state" id="individualState">
                                                <option value="">Please select</option>
                                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                                <option value="Arunachal Pradesh">Arunachal Pradesh</option>
                                                <option value="Assam">Assam</option>
                                                <option value="Bihar">Bihar</option>
                                                <option value="Chhattisgarh">Chhattisgarh</option>
                                                <option value="Goa">Goa</option>
                                                <option value="Gujarat">Gujarat</option>
                                                <option value="Haryana">Haryana</option>
                                                <option value="Himachal Pradesh">Himachal Pradesh</option>
                                                <option value="Jharkhand">Jharkhand</option>
                                                <option value="Karnataka">Karnataka</option>
                                                <option value="Kerala">Kerala</option>
                                                <option value="Madhya Pradesh">Madhya Pradesh</option>
                                                <option value="Maharashtra">Maharashtra</option>
                                                <option value="Manipur">Manipur</option>
                                                <option value="Meghalaya">Meghalaya</option>
                                                <option value="Mizoram">Mizoram</option>
                                                <option value="Nagaland">Nagaland</option>
                                                <option value="Odisha">Odisha</option>
                                                <option value="Punjab">Punjab</option>
                                                <option value="Rajasthan">Rajasthan</option>
                                                <option value="Sikkim">Sikkim</option>
                                                <option value="Tamil Nadu">Tamil Nadu</option>
                                                <option value="Telangana">Telangana</option>
                                                <option value="Tripura">Tripura</option>
                                                <option value="Uttar Pradesh">Uttar Pradesh</option>
                                                <option value="Uttarakhand">Uttarakhand</option>
                                                <option value="West Bengal">West Bengal</option>
                                                <option value="Andaman and Nicobar Islands">Andaman and Nicobar
                                                    Islands
                                                </option>
                                                <option value="Chandigarh">Chandigarh</option>
                                                <option value="Dadra and Nagar Haveli and Daman and Diu">Dadra and Nagar
                                                    Haveli and Daman and Diu
                                                </option>
                                                <option value="Lakshadweep">Lakshadweep</option>
                                                <option value="Delhi">Delhi</option>
                                                <option value="Puducherry">Puducherry</option>
                                                <option value="Ladakh">Ladakh</option>
                                                <option value="Jammu & Kashmir">Jammu & Kashmir</option>
                                            </select>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="city" class="form-label">City</label>
                                            <input type="text" class="form-control" id="individualCity"
                                                   placeholder="City"
                                                   required>
                                        </div>
                                        <div class="col-xl-4 col-lg-4 col-md-6 mb-3">
                                            <label for="postcode" class="form-label">Postcode</label>
                                            <input type="text" class="form-control" id="individualPostcode"
                                                   placeholder="Postcode"
                                                   required>
                                        </div>

                                        <!-- Buttons Section -->
                                        <div class="d-flex justify-content-end">
                                            <button type="button" class="btn btn-secondary me-2" id="closeFormBtn"
                                                    data-bs-dismiss="modal">Close
                                            </button>
                                            <button type="submit" class="btn btn-primary" id="saveIndividualChanges">
                                                Submit
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer start -->
        {% include 'product_tracking/footer.html' %}
        <!-- Footer end -->
    </div>
    <!-- Main wrapper end -->

    <!-- Scripts -->
    <script>

        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('addCompanyRow').addEventListener('click', function () {
                var myModal = new bootstrap.Modal(document.getElementById('categoryModal'));
                myModal.show();
            });

            document.getElementById('addVenueRow').addEventListener('click', function () {
                console.log('Venue Row clicked');
                var myModal1 = new bootstrap.Modal(document.getElementById('venueModal'));
                myModal1.show();
            });

            document.getElementById('addIndividualRow').addEventListener('click', function () {
                var myModal2 = new bootstrap.Modal(document.getElementById('individualModal'));
                myModal2.show();
            });
        });

        $(document).ready(function () {

            // Initialize tooltips
            $('[data-bs-toggle="tooltip"]').tooltip();

            $('#search-input').on('input', function () {
                let searchTerm = $(this).val().toLowerCase();

                $('#company-table-body tr').each(function () {
                    $(this).toggle($(this).text().toLowerCase().indexOf(searchTerm) > -1);
                });

                $('#venue-table-body tr').each(function () {
                    $(this).toggle($(this).text().toLowerCase().indexOf(searchTerm) > -1);
                });

                $('#individual-table-body tr').each(function () {
                    $(this).toggle($(this).text().toLowerCase().indexOf(searchTerm) > -1);
                });
            });

            // Save Company, Venue or Individual Row
            $(document).on('click', '#saveCompanyChanges, #saveVenueChanges, #saveIndividualChanges', function () {
                let data = {};
                let formId = $(this).closest('form').attr('id');  // Get the closest form ID

                if (formId === 'companyInformationForm') {
                    data = {
                        type: 'company',
                        company_name: $('#companyName').val(),
                        gst_no: $('#gstNo').val(),
                        pan_no: $('#panNo').val(),
                        company_email: $('#companyEmail').val(),
                        office_address: $('#officeAddress').val(),
                        billing_address: $('#billingAddress').val(),
                        country: $('#country').val(),
                        state: $('#state').val(),
                        city: $('#city').val(),
                        post_code: $('#postcode').val(),
                    };
                } else if (formId === 'venueInformationForm') {
                    data = {
                        type: 'venue',
                        venue_name: $('#venueName').val(),
                        venue_address: $('#venueAddress').val(),
                        venue_country: $('#venueCountry').val(),
                        venue_state: $('#venueState').val(),
                        venue_city: $('#venueCity').val(),
                        venue_postcode: $('#venuePostcode').val(),
                    };
                } else if (formId === 'individualInformationForm') {
                    data = {
                        type: 'individual',
                        individual_name: $('#individualName').val(),
                        individual_mobile: $('#individualMobileNo').val(),
                        individual_social: $('#individualSocialNo').val(),
                        individual_email: $('#individualEmail').val(),
                        individual_company: $('#individualCompanyName').val(),
                        individual_address: $('#individualAddress').val(),
                        individual_country: $('#individualCountry').val(),
                        individual_state: $('#individualState').val(),
                        individual_city: $('#individualCity').val(),
                        individual_postcode: $('#individualPostcode').val(),
                    };
                }

                $.ajax({
                    url: '/add_row/',  // Assuming /add_row/ is the endpoint
                    type: 'POST',
                    data: data,
                    headers: {
                        'X-CSRFToken': '{{ csrf_token }}' // Add CSRF token
                    },
                    success: function (response) {
                        if (response.status === 'success') {
                            alert('Data saved successfully!');
                            location.reload();
                        } else {
                            // Display error message for duplicate entry or any other error
                            alert('Failed to save data: ' + response.message);
                        }
                    },
                    error: function (xhr, status, error) {
                        alert('Error: ' + error);
                    }
                });
            });


            // Fetch data on page load
            fetchCompanyData();
            fetchVenueData();
            fetchIndividualData();

            function fetchCompanyData() {
                $.ajax({
                    url: '{% url "fetch_company_data" %}',
                    type: 'GET',
                    success: function (data) {
                        $('#company-table-body').empty();
                        $.each(data, function (index, item) {
                            $('#company-table-body').append(
                                `<tr data-id="${item.id}">
                        <td>
                            <button class="btn btn-sm btn-primary edit-btn me-2"><i class="fa fa-pencil"></i></button>
                            <button class="btn btn-sm btn-success save-btn me-2" style="display:none;"><i class="fa fa-save"></i></button>
                            <button class="btn btn-sm btn-secondary cancel-company-btn me-2" style="display:none;"><i class="fa fa-times"></i></button>
                            <button class="btn btn-sm btn-danger delete-btn me-2"><i class="fa fa-trash"></i></button>
                        </td>
                        <td class="company-name-cell"><span class="company-name-text">${item.company_name}</span>
                            <input type="text" class="form-control company-name" value="${item.company_name}" style="display:none;">
                        </td>
                        <td class="gst-no-cell"><span class="gst-no-text">${item.gst_no}</span>
                            <input type="text" class="form-control gst-no" value="${item.gst_no}" style="display:none;">
                        </td>
                        <td class="pan-no-cell"><span class="pan-no-text">${item.pan_no}</span>
                            <input type="text" class="form-control pan-no" value="${item.pan_no}" style="display:none;">
                        </td>
                        <td class="company-email-cell"><span class="company-email-text">${item.company_email}</span>
                            <input type="text" class="form-control company-email" value="${item.company_email}" style="display:none;">
                        </td>
                        <td class="office-address-cell"><span class="office-address-text">${item.office_address}</span>
                            <input type="text" class="form-control office-address" value="${item.office_address}" style="display:none;">
                        </td>
                        <td class="billing-address-cell"><span class="billing-address-text">${item.billing_address}</span>
                            <input type="text" class="form-control billing-address" value="${item.billing_address}" style="display:none;">
                        </td>
                        <td class="city-cell"><span class="city-text">${item.city}</span>
                            <input type="text" class="form-control city" value="${item.city}" style="display:none;">
                        </td>
                        <td class="state-cell"><span class="state-text">${item.state}</span>
                            <input type="text" class="form-control state" value="${item.state}" style="display:none;">
                        </td>
                        <td class="country-cell"><span class="country-text">${item.country}</span>
                            <input type="text" class="form-control country" value="${item.country}" style="display:none;">
                        </td>                        
                        <td class="post-code-cell"><span class="post-code-text">${item.post_code}</span>
                            <input type="text" class="form-control post-code" value="${item.post_code}" style="display:none;">
                        </td>
                    </tr>`
                            );
                        });
                    },
                    error: function (xhr, status, error) {
                        console.error('Error fetching data:', error);
                    }
                });
            }

            // Function to fetch and populate venue data
            function fetchVenueData() {
                $.ajax({
                    url: '{% url "fetch_venue_data" %}',
                    type: 'GET',
                    success: function (data) {
                        $('#venue-table-body').empty();
                        $.each(data, function (index, item) {
                            $('#venue-table-body').append(
                                `<tr data-id="${item.id}">
                        <td>
                            <button class="btn btn-sm btn-primary edit-venue-btn me-2"><i class="fa fa-pencil"></i></button>
                            <button class="btn btn-sm btn-success save-venue-btn me-2" style="display:none;"><i class="fa fa-save"></i></button>
                            <button class="btn btn-sm btn-secondary cancel-venue-btn me-2" style="display:none;"><i class="fa fa-times"></i></button>
                            <button class="btn btn-sm btn-danger delete-btn me-2"><i class="fa fa-trash"></i></button>
                        </td>
                        <td class="venue-name-cell"><span class="venue-name-text">${item.venue_name}</span>
                            <input type="text" class="form-control venue-name" value="${item.venue_name}" style="display:none;">
                        </td>
                        <td class="venue-address-cell"><span class="venue-address-text">${item.venue_address}</span>
                            <input type="text" class="form-control venue-address" value="${item.venue_address}" style="display:none;">
                        </td>
                        <td class="city-cell"><span class="city-text">${item.city}</span>
                            <input type="text" class="form-control city" value="${item.city}" style="display:none;">
                        </td>
                        <td class="state-cell"><span class="state-text">${item.state}</span>
                            <input type="text" class="form-control state" value="${item.state}" style="display:none;">
                        </td>
                        <td class="country-cell"><span class="country-text">${item.country}</span>
                            <input type="text" class="form-control country" value="${item.country}" style="display:none;">
                        </td>                        
                        <td class="post-code-cell"><span class="post-code-text">${item.post_code}</span>
                            <input type="text" class="form-control post-code" value="${item.post_code}" style="display:none;">
                        </td>
                    </tr>`
                            );
                        });
                    },
                    error: function (xhr, status, error) {
                        console.error('Error fetching data:', error);
                    }
                });
            }

            // Fetch company names when the modal is shown
            $('#individualModal').on('shown.bs.modal', function () {
                fetchCompanyNames();
            });

            // Function to fetch and populate venue data
            function fetchCompanyNames() {
                $.ajax({
                    url: '{% url "fetch_company_names" %}',
                    success: function (data) {
                        const dropdown = $('#individualCompanyName'); // Select the dropdown element

                        // Clear existing options
                        dropdown.empty();

                        // Populate the dropdown with new options
                        $.each(data, function (index, item) {
                            dropdown.append(`<option value="${item.company_name}">${item.company_name}</option>`);
                        });
                    },
                    error: function (xhr, status, error) {
                        console.error('Error fetching company names:', error);
                    }
                });
            }

            // Function to fetch and populate individual data
            function fetchIndividualData() {
                $.ajax({
                    url: '{% url "fetch_individual_data" %}',
                    type: 'GET',
                    success: function (data) {
                        $('#individual-table-body').empty();
                        $.each(data, function (index, item) {
                            $('#individual-table-body').append(
                                `<tr data-id="${item.id}">
                        <td>
                            <button class="btn btn-sm btn-primary edit-individual-btn me-2"><i class="fa fa-pencil"></i></button>
                            <button class="btn btn-sm btn-success save-individual-btn me-2" style="display:none;"><i class="fa fa-save"></i></button>
                            <button class="btn btn-sm btn-secondary cancel-individual-btn me-2" style="display:none;"><i class="fa fa-times"></i></button>
                            <button class="btn btn-sm btn-danger delete-btn me-2"><i class="fa fa-trash"></i></button>
                        </td>
                        <td class="individual-name-cell"><span class="individual-name-text">${item.individual_name}</span>
                            <input type="text" class="form-control individual-name" value="${item.individual_name}" style="display:none;">
                        </td>
                        <td class="mobile-no-cell"><span class="mobile-no-text">${item.mobile_no}</span>
                            <input type="text" class="form-control mobile-no" value="${item.mobile_no}" style="display:none;">
                        </td>
                        <td class="social-no-cell"><span class="social-no-text">${item.social_no}</span>
                            <input type="text" class="form-control social-no" value="${item.social_no}" style="display:none;">
                        </td>
                        <td class="individual-email-cell"><span class="individual-email-text">${item.individual_email}</span>
                            <input type="text" class="form-control individual-email" value="${item.individual_email}" style="display:none;">
                        </td>
                        <td class="company-cell"><span class="company-text">${item.company}</span>
                            <input type="text" class="form-control company" value="${item.company}" style="display:none;">
                        </td>
                        <td class="individual-address-cell"><span class="individual-address-text">${item.individual_address}</span>
                            <input type="text" class="form-control individual-address" value="${item.individual_address}" style="display:none;">
                        </td>
                        <td class="city-cell"><span class="city-text">${item.city}</span>
                            <input type="text" class="form-control city" value="${item.city}" style="display:none;">
                        </td>
                        <td class="state-cell"><span class="state-text">${item.state}</span>
                            <input type="text" class="form-control state" value="${item.state}" style="display:none;">
                        </td>
                        <td class="country-cell"><span class="country-text">${item.country}</span>
                            <input type="text" class="form-control country" value="${item.country}" style="display:none;">
                        </td>                        
                        <td class="post-code-cell"><span class="post-code-text">${item.post_code}</span>
                            <input type="text" class="form-control post-code" value="${item.post_code}" style="display:none;">
                        </td>
                    </tr>`
                            );
                        });
                    },
                    error: function (xhr, status, error) {
                        console.error('Error fetching data:', error);
                    }
                });
            }

            $(document).on('click', '.edit-btn', function () {
                const row = $(this).closest('tr');
                row.find('input').show();
                row.find('span').hide();
                row.find('.edit-btn, .delete-btn').hide();
                row.find('.save-btn, .cancel-company-btn').show();
            });

            $(document).on('click', '.save-btn', function () {
                const row = $(this).closest('tr');
                const id = row.data('id');
                const data = {
                    company_name: row.find('.company-name').val(),
                    gst_no: row.find('.gst-no').val(),
                    pan_no: row.find('.pan-no').val(),
                    company_email: row.find('.company-email').val(),
                    office_address: row.find('.office-address').val(),
                    billing_address: row.find('.billing-address').val(),
                    country: row.find('.country').val(),
                    state: row.find('.state').val(),
                    city: row.find('.city').val(),
                    post_code: row.find('.post-code').val(),
                };

                $.ajax({
                    url: '{% url "update_company_data" %}',
                    type: 'POST',
                    data: {
                        id: id,
                        ...data,
                        csrfmiddlewaretoken: '{{ csrf_token }}'
                    },
                    success: function (response) {
                        row.find('input').hide();
                        row.find('span').show().each(function () {
                            const span = $(this);
                            const input = span.siblings('input');
                            span.text(input.val());
                        });
                        row.find('.edit-btn, .delete-btn').show();
                        row.find('.save-btn, .cancel-company-btn').hide();
                    },
                    error: function (xhr, status, error) {
                        console.error('Error updating data:', error);
                    }
                });
            });

            $(document).on('click', '.cancel-company-btn, .cancel-venue-btn', function () {
                const row = $(this).closest('tr');
                row.find('input').hide();
                row.find('span').show();
                row.find('.edit-btn, .delete-btn').show();
                row.find('.save-btn, .cancel-company-btn').hide();
            });

            // Handle edit button click
            $(document).on('click', '.edit-venue-btn', function () {
                const row = $(this).closest('tr');
                row.find('input').show();
                row.find('span').hide();
                row.find('.edit-venue-btn, .delete-btn').hide();
                row.find('.save-venue-btn, .cancel-venue-btn').show();
            });

            // Handle save button click
            $(document).on('click', '.save-venue-btn', function () {
                const row = $(this).closest('tr');
                const id = row.data('id');
                const data = {
                    venue_name: row.find('.venue-name').val(),
                    venue_address: row.find('.venue-address').val(),
                    country: row.find('.country').val(),
                    state: row.find('.state').val(),
                    city: row.find('.city').val(),
                    post_code: row.find('.post-code').val(),
                };

                $.ajax({
                    url: '{% url "update_venue_data" %}',
                    type: 'POST',
                    data: {
                        id: id,
                        ...data,
                        csrfmiddlewaretoken: '{{ csrf_token }}'
                    },
                    success: function (response) {
                        row.find('input').hide();
                        row.find('span').show().each(function () {
                            const span = $(this);
                            const input = span.siblings('input');
                            span.text(input.val());
                        });
                        row.find('.edit-venue-btn, .delete-btn').show();
                        row.find('.save-venue-btn, .cancel-venue-btn').hide();
                    },
                    error: function (xhr, status, error) {
                        console.error('Error updating data:', error);
                    }
                });
            });

            // Handle cancel button click
            $(document).on('click', '.cancel-venue-btn', function () {
                const row = $(this).closest('tr');
                row.find('input').hide();
                row.find('span').show();
                row.find('.edit-venue-btn, .delete-btn').show();
                row.find('.save-venue-btn, .cancel-venue-btn').hide();
            });

            // Handle edit button click
            $(document).on('click', '.edit-individual-btn', function () {
                const row = $(this).closest('tr');
                row.find('input').show();
                row.find('span').hide();
                row.find('.edit-individual-btn, .delete-btn').hide();
                row.find('.save-individual-btn, .cancel-individual-btn').show();
            });

            // Handle save button click
            $(document).on('click', '.save-individual-btn', function () {
                const row = $(this).closest('tr');
                const id = row.data('id');
                const data = {
                    individual_name: row.find('.individual-name').val(),
                    mobile_no: row.find('.mobile-no').val(),
                    social_no: row.find('.social-no').val(),
                    individual_email: row.find('.individual-email').val(),
                    company: row.find('.company').val(),
                    individual_address: row.find('.individual-address').val(),
                    country: row.find('.country').val(),
                    state: row.find('.state').val(),
                    city: row.find('.city').val(),
                    post_code: row.find('.post-code').val(),
                };

                $.ajax({
                    url: '{% url "update_individual_data" %}',
                    type: 'POST',
                    data: {
                        id: id,
                        ...data,
                        csrfmiddlewaretoken: '{{ csrf_token }}'
                    },
                    success: function (response) {
                        row.find('input').hide();
                        row.find('span').show().each(function () {
                            const span = $(this);
                            const input = span.siblings('input');
                            span.text(input.val());
                        });
                        row.find('.edit-individual-btn, .delete-btn').show();
                        row.find('.save-individual-btn, .cancel-individual-btn').hide();
                    },
                    error: function (xhr, status, error) {
                        console.error('Error updating data:', error);
                    }
                });
            });

            // Handle cancel button click
            $(document).on('click', '.cancel-individual-btn', function () {
                const row = $(this).closest('tr');
                row.find('input').hide();
                row.find('span').show();
                row.find('.edit-individual-btn, .delete-btn').show();
                row.find('.save-individual-btn, .cancel-individual-btn').hide();
            });

            // Function to delete an item (company, venue, or individual)
            $(document).on('click', '.delete-btn', function () {
                const row = $(this).closest('tr');
                const id = row.data('id');
                console.log('click row ID:', id)
                //const type = $(this).data('type'); /console.log('Clicked row TYPE:', type)
                if (confirm(`Are you sure you want to delete this row?`)) {
                    $.ajax({
                        url: '{% url "delete_data" %}',
                        type: 'POST',
                        data: {
                            'id': id,
                            'csrfmiddlewaretoken': '{{ csrf_token }}'
                        },
                        success: function (response) {
                            if (response.status === 'success') {
                                row.remove(); // Remove the row from the table
                            } else {
                                alert('Error: ' + response.message);
                            }
                        },
                        error: function (xhr, status, error) {
                            console.error('Error deleting data:', error);
                            alert('An error occurred while deleting the data.');
                        }
                    });
                }
            });
        });
    </script>
    </body>
{% endblock %}
